<!DOCTYPE html>
<html>
<head>
    <!-- Pyodide and CodeMirror -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/pastel-on-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="192x192" href="../assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../assets/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="../assets/android-chrome-512x512.png">
    
    <!-- Core Stylesheets -->
    <link rel="stylesheet" href="../assets/colours.css">
    <link rel="stylesheet" href="../assets/shared-styles.css">
    <link rel="stylesheet" href="../assets/nav-bar.css">
    <link rel="stylesheet" href="../assets/module_card.css">
    <link rel="stylesheet" href="../assets/learning_outcomes.css">
    <link rel="stylesheet" href="../assets/learning_lists.css">
    <link rel="stylesheet" href="../assets/box_styles.css">
    <link rel="stylesheet" href="../assets/code_styles.css">

    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L2D - PF1 - Errors in Python</title>
    
    <!-- File URLs for this lesson -->
    <script>window.LESSON_FILES = []; window.LESSON_PACKAGES = [];</script>
        
</head>
<body>
    
    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
        </div>
        
        <h3>Content</h3>
        <ul>
            <li><a href="./introduction.html" class="">Introduction</a></li><li><a href="./input-output-operations.html">Input/Output Operations</a></li><li><a href="./logical-operations-and-conditional-statements.html">Logical Operations and Conditional Statements</a></li>
            <li>
                <div class="nav-toggle active" data-target="expandable-section-3">
                    Errors in Python
                    <span class="toggle-icon">▼</span>
                </div>
                <ul class="nested-nav expanded" id="expandable-section-3"><li><a href="#introduction">Introduction</a></li><li><a href="#syntax-errors">Syntax errors</a></li><li><a href="#runtime-errors">Runtime errors</a></li><li><a href="#error-handling">Error handling</a></li><li><a href="#summary">Summary</a></li>
                </ul>
            </li><li><a href="./assignment.html">Assignment</a></li><li><a href="./feedback.html">Feedback</a></li>
        </ul>

        <h3 class="collapsible-header collapsed">
            Resources
            <span class="collapse-icon">►</span>
        </h3>
        <div class="collapsible-content collapsed">
            <ul>
                <li><a href="./glossary.html">Glossary</a></li><li><a href="./downloads.html">Downloads</a></li><li><a href="../HB/introduction.html">Handbook</a></li>
            </ul>
        </div>

        <h3 class="collapsible-header collapsed">
            Previous Modules
            <span class="collapse-icon">►</span>
        </h3>
        <div class="collapsible-content collapsed">
            <ul>
            <li><a href="../PF0/introduction.html">PF0</a></li>
        </ul>
        </div>

        <h3>
            <li><a href="./report-issue.html">Report an Issue</a></li>
        </h3>
    </div>
    
    <!-- Sidebar Toggle Button -->
    <button id="sidebar-toggle" class="sidebar-toggle">❮</button>
    
    <!-- Main Content Area -->
    <div id="main-content" class="main-content">
        <!-- Top Navigation Bar -->
        <div class="top-navbar">
            <h1 class="page-title">Python Fundamentals 1</h1>
            <div class="nav-actions">
            </div>
        </div>

        
            <div class="module-card" id="introduction">
                <div class="module-header">
                    Errors in Python <span class="module-tag">PF1</span>
                </div>
                <div class="module-body">
                    <h3>Learning Objectives</h3>
                    <div class="learning-outcomes">
                        <div class="outcome-item">
                    <span class="outcome-number">1</span>
                    <span class="outcome-text">What is an error?</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">2</span>
                    <span class="outcome-text">To understand different types of errors</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">3</span>
                    <span class="outcome-text">Identifying common errors</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">4</span>
                    <span class="outcome-text">How to handle errors programmatically</span>
                </div>
                    </div>
                    <h3>Introduction</h3>
                    <p><strong>What are errors in Python?</strong> As with many programming languages, Python has built-in error reporting: a system whereby problems that stop a program from running as intended, are reported to the user, on the console. Errors occur when the Python interpreter encounters a line or syntax that it cannot understand, or cannot execute.<br><br>These errors fall into two broad categories:<br><ul class="nested-list"><li><strong>syntax errors</strong> - these happen when the rules of the Python language are broken (such as missing colons or brackets).</li><br><li><strong>runtime errors</strong> - these occur while a program is running, when otherwise valid code fails during its execution.</li></ul>When an error occurs, Python generates an error message called a <strong>traceback</strong>. These tracebacks explain what went wrong to cause the error, and where in the code the problem occurred. Learning to read and understand these error messages is of paramount importance. When writing code, and testing its execution, these errors help to quickly pinpoint where the problems occur, allowing us to repair or <strong>debug</strong> the code with ease, and precision. Thus, they build into us as programmers, training sharper problem-solving strategies within us that lead us to writing more robust code.</p>
                </div>
            </div>
            
            <div class="module-card" id="syntax-errors">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Syntax errors</h3>
                        <p>We have already defined these as errors that arise when Python’s “grammar” or language rules have been broken. They prevent the program from even starting to run, because the interpreter cannot make sense of the code structure. Syntax errors are often the first type of error that new programmers encounter, and the good news is that they are usually easy to spot once you know what to look for.<br><br>Common examples of syntax errors include:<br><ul class="nested-list"><li><strong>Missing or unmatched quotes</strong> – forgetting to close a string with the same quotation mark you opened it with</li><br><li><strong>Missing or unmatched parentheses</strong> – leaving out a bracket, or using one too many</li><br><li><strong>Missing colons</strong> – forgetting the colon <code>:</code> that must follow an <code>if</code>, <code>elif</code>, <code>else</code> conditional (as we looked at, previously) or later on in the course, a <code>for</code> and <code>while</code> loop</li><br><li><strong>Incorrect indentation</strong> – not lining up code blocks with the correct number of spaces or tabs</li><br><li><strong>Misspelled keywords</strong> – for instance, typing <code>pritn</code> instead of <code>print</code>, or <code>esle</code> instead of <code>else</code></li><br><li><strong>Illegal characters</strong> – including symbols or characters that Python does not recognise</li></ul>When Python encounters one of these problems, it produces a <code>SyntaxError</code> message and highlights the part of the code it cannot interpret. The caret <code>^</code> symbol in an error message often <em>points to the exact spot</em> where the interpreter got confused. It may not always be the true location of the mistake, but it is usually close by. Developing the habit of carefully reading error messages and checking for these common issues is the first step towards becoming fluent in <strong>debugging</strong> - a term used to describe spotting errors or &#x27;bugs&#x27; in code that impede its execution.<br><br>We will generate each of the different types of <code>SyntaxError</code> in the cells, below:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-51"># Missing quotes around a string:

print(&quot;Gene symbol: BRCA1)</textarea>
            </div>
            <button id="run-code-cell-51" class="run-button">Run Code</button>
            <div id="code-cell-51-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-52"># Unmatched parentheses around a function&#x27;s arguments:

print(&quot;Heart rate (bpm):&quot;, heart_rate</textarea>
            </div>
            <button id="run-code-cell-52" class="run-button">Run Code</button>
            <div id="code-cell-52-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-53"># Missing colon in a conditional statement:

temperature = 38.2

if temperature &gt; 37.5
    print(&quot;Fever detected&quot;)</textarea>
            </div>
            <button id="run-code-cell-53" class="run-button">Run Code</button>
            <div id="code-cell-53-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-54"># Missing indentation in a conditional statement:

wbc = 12000

if wbc &gt; 11000:
print(&quot;Leukocytosis&quot;)  # This line should be indented (one tab, or four spaces)</textarea>
            </div>
            <button id="run-code-cell-54" class="run-button">Run Code</button>
            <div id="code-cell-54-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-55"># Misspelling:

bmi = 31.4

if bmi &gt;= 30:
    print(&quot;Obese.&quot;)

esle:                       # In this line, &#x27;else&#x27; is misspelled.
    print(&quot;Not obese.&quot;)</textarea>
            </div>
            <button id="run-code-cell-55" class="run-button">Run Code</button>
            <div id="code-cell-55-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-56"># Illegal characters:

glucose@level = 5.6   # The &#x27;@&#x27; character is not allowed in a variable name</textarea>
            </div>
            <button id="run-code-cell-56" class="run-button">Run Code</button>
            <div id="code-cell-56-output" class="output"></div>
        </div>
        <p>Upon reading the error messages, among the many things you will have noticed, is how informative they are. Not only do they diagnose the error and its location in your code, but they often also offer suggested fixes.</p>
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>For code with multiple errors, the Python interpreter will cease immediately upon hitting the <strong>first error</strong>. Thus, you will only get error reporting on subsequent errors, once the first error has been fixed. This leads to the continuous struggle of a programmer where fixing one error just brings you more.</p>
            </div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="runtime-errors">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Runtime errors</h3>
                        <p>Unlike syntax errors, which prevent completley prevent a program from running, <strong>runtime errors</strong> occur <em>while</em> the program is already running. Thus, a <code>RuntimeError</code> indicates that the code is written in a way that Python can understand <em>syntactically</em>, but when it tries to execute a particular line, something goes wrong along the way. Runtime errors are also referred to as <strong>exceptions</strong>, as they represent when the program&#x27;s normal flow is interrupted, in some way. They are among the most common errors you will encounter as you gain experience, and your programs build both in terms of complexity and interactivity.<br><br>A key feature of runtime errors is that they stop your program only <em>at the point where the problem occurs</em>. Everything <em>before</em> the error will have run successfully, but nothing after it will execute until the error is resolved.<br><br>The error message provides a <em>traceback</em> that explains what type of error occurred, together with the exact line number where the problem was triggered. A traceback is a unique type of error message in Python, where a report of all the steps the interpreter ran successfully up until the point of the error, are listed out. If and where applicable, this traceback will tell you the file name, line number and the type of error which, again, informs the user as copiously as possible, so that debugging is made easy.<br><br>Common types of runtime errors include:<br><ul class="nested-list"><li><strong><code>NameError</code></strong> – using a variable that has not been defined</li><br><li><strong><code>TypeError</code></strong> – performing an operation on the wrong data type (e.g. <code>&quot;DNA&quot; + 5</code>)</li><br><li><strong><code>ValueError</code></strong> – passing an invalid value to a function (e.g. <code>int(&quot;gene&quot;)</code>)</li><br><li><strong><code>ZeroDivisionError</code></strong> – attempting to divide a number by zero</li><br><li><strong><code>IndexError</code></strong> – trying to access a position outside the bounds of a list or string</li><br><li><strong><code>KeyError</code></strong> – looking up a dictionary key that does not exist</li><br><li><strong><code>ImportError</code> / <code>ModuleNotFoundError</code></strong> – when Python cannot locate the module you are trying to import</li></ul>By learning to read and interpret these error messages, you can quickly trace back to the source of the problem and decide how best to correct it.<br><br>In the cells below, let&#x27;s generate some runtime errors, and see a few of these examples, in action.</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-57"># NameError – referring to a variable that has not been defined:

print(gene_sequence)</textarea>
            </div>
            <button id="run-code-cell-57" class="run-button">Run Code</button>
            <div id="code-cell-57-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-58"># TypeError – performing an operation on the wrong data type:

dna = &quot;ATCG&quot;

print(dna + 5)   # Adding or concatenating a string + integer is not valid.</textarea>
            </div>
            <button id="run-code-cell-58" class="run-button">Run Code</button>
            <div id="code-cell-58-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-59"># ValueError – passing an invalid value to a function:

int(&quot;adenine&quot;)   # Cannot convert letters into an integer.</textarea>
            </div>
            <button id="run-code-cell-59" class="run-button">Run Code</button>
            <div id="code-cell-59-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-60"># ZeroDivisionError – attempting to divide a number by zero:

cell_count = 1000
replicates = 0

average = cell_count / replicates</textarea>
            </div>
            <button id="run-code-cell-60" class="run-button">Run Code</button>
            <div id="code-cell-60-output" class="output"></div>
        </div>
        
        <div class="info-box remember-box">
            <div class="box-title">
                <span class="box-icon"></span>
                REMEMBER
            </div>
            <div class="box-content">
                <p>The last three types of <code>RuntimeError</code> listed in this lesson, go beyond the lesson&#x27;s scope. That is - they pertain to concepts and structures in Python that we have not covered, yet. For completeness, they are listed here, as they are important types of runtime errors, that you may encounter, further on in your Python learning.</p>
            </div>
        </div>
        <h4>Errors you&#x27;ll see in the future</h4><p>The errors you will see below are specific to some data structures in Python that we will be exploring in more detail in the next modules <strong>PF2</strong> and <strong>PF3</strong>. We&#x27;ll give a brief description here for you to understand the error, however there will be more information in the future to understand the terminology properly.</p><p>Below is a <strong>list</strong> which is a type of data structure that can store multiple &#x27;elements&#x27; or items (covered in <strong>PF2</strong>), which can be accessed individually using a technique or system called <strong>indexing</strong>.<br><br>In the case where an index is given that is greater than the actual number of elements in the list, you get a specific error known as an <code>IndexError</code>, as demonstrated, below:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-61"># IndexError – trying to access a position outside the bounds of a list or string:

genes = [&quot;BRCA1&quot;, &quot;TP53&quot;, &quot;EGFR&quot;]

print(genes[5])   # The</textarea>
            </div>
            <button id="run-code-cell-61" class="run-button">Run Code</button>
            <div id="code-cell-61-output" class="output"></div>
        </div>
        <p>Similarly, this error is attributed to another type of associative data structure called a <strong>dictionary</strong> (covered in <strong>PF3</strong>), which contains multiple key:value pairs. A value is accessed by using its associated key, and if a key is used that is not in the dictionary, you get a specific <code>KeyError</code> as shown, below&quot;:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-62"># KeyError – looking up a dictionary key that does not exist

expression = {&quot;BRCA1&quot;: 2.5, &quot;TP53&quot;: 4.1}

print(expression[&quot;MYC&quot;])   # &quot;MYC&quot; key not in dictionary</textarea>
            </div>
            <button id="run-code-cell-62" class="run-button">Run Code</button>
            <div id="code-cell-62-output" class="output"></div>
        </div>
        <p>Lastly, in Python you can import modules or packages of code to expand Python (covered in <strong>PF3</strong>). In short, these are authored collections of Python functions, methods and attributes that allow users to perform specific functions, not included in Python, by default. They, therefore, often have to be explicitly imported and installed to be implemented in your code. In the case that they haven&#x27;t been, Python will throw a <code>ModuleNotFoundError</code>, as demonstrated, below:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-63"># ImportError / ModuleNotFoundError – module cannot be found
import genomics_toolkit   # not a real or installed module</textarea>
            </div>
            <button id="run-code-cell-63" class="run-button">Run Code</button>
            <div id="code-cell-63-output" class="output"></div>
        </div>
        
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p>One potential area of confusion to be clear on, is the interchangeability of the terms <strong>run time error</strong> and <strong>exception</strong>. In Python, runtime errors are represented <em>as</em> <strong>exceptions</strong>: that is, as special events that interrupt the normal flow of a program when the interpreter encounters something it cannot handle during execution, such as dividing by zero or using an undefined variable. As we have explored, each exception has a specific name (like <code>NameError</code> or <code>TypeError</code>) and is reported with a <strong>traceback</strong> that shows where the error occurred.<br><br>While people often use <em>runtime error</em> and <em>exception</em> interchangeably, it is more precise to say that <strong>runtime errors in Python appear as exceptions</strong>, with each exception type describing the exact problem.</p>
            </div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="error-handling">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Error handling</h3>
                        <h4>`try` and `except`:</h4><p>So far, we have covered how exceptions are raised whenever Python encounters a problem during execution. By default, these exceptions stop the program <em>completely</em>, which is often helpful for debugging but not always desirable if you want your program to continue running, just to see how far it gets, for instance.<br><br>Python therefore provides an elegant way to <em>handle</em> exceptions using the keywords <code>try</code> and <code>except</code>. This allows you to wrap a block of code in a <code>try</code> statement, and if an exception occurs, the program will <em>catch</em> it and execute the code inside the corresponding <code>except</code> block instead of crashing. This is not dissimilar to how a conditional statement works, in that if an error occurs, an alternative &#x27;route&#x27; through the program is provided, to try and circumvent it.<br><br>In this way, <code>try</code> and <code>except</code> give you tight control over how your program responds to errors, enabling you to display useful messages back to the console, take alternative actions or safely recover the point you reached without stopping the entire program. If your program is editing, writing or overwriting important data, for example, these recovery options can be invaluable in preventing irreparable damage from occurring.</p><h4>Syntax</h4><p>Similar to the conditional statements we looked at earlier in this lesson, the <code>try</code> keyword is followed by a colon <code>:</code>, and hitting return auto-indents the next line by a single tab space. All lines on this indentation level will then specify the code that is <em>wrapped</em> by the <code>try</code> keyword.<br><br>If we exit the scope of <code>try</code> on a new line, we can then use the <code>except</code> keyword, to specify alternative &#x27;solution&#x27; code, should a particular runtime error or exception occur in the <code>try</code> block.<br><br>Run the code in the cell below. Python will raise a <code>ZeroDivisionError</code>:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-64">cell_count = 1000
replicates = 0

average = cell_count / replicates

print(f&quot;Average cells per replicate: {average}&quot;)</textarea>
            </div>
            <button id="run-code-cell-64" class="run-button">Run Code</button>
            <div id="code-cell-64-output" class="output"></div>
        </div>
        <p>If we wrap the same code in a <code>try</code> statement, and use <code>except</code> to run code that prints an error message of our choosing to the console, Python no longer raises an error. Instead, it runs the code wrapped in the <code>except</code> statement, as a &#x27;solution&#x27; should a specified <code>ZeroDivisionError</code> be raised.<br><br>As follows:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-65"># ZeroDivisionError

try:

    cell_count = 1000
    replicates = 0

    average = cell_count / replicates
    
    print(f&quot;Average cells per replicate: {average}&quot;)

except ZeroDivisionError:
    
    print(&quot;Error: number of replicates cannot be zero.&quot;)</textarea>
            </div>
            <button id="run-code-cell-65" class="run-button">Run Code</button>
            <div id="code-cell-65-output" class="output"></div>
        </div>
        <p>Similarly, run the cell below, and enter your age as a word (string), and a <code>ValueError</code> will raise, because the <code>int</code> class expects numeric characters as input, only. In this case, instead of Python&#x27;s internal error reporting displaying, the <code>except</code> statement&#x27;s code will execute:</p>
        <div class="code-area hidden-code" style="display: none;">
            <div class="code-container">
                <textarea id="code-cell-66">import js

def input(prompt=&quot;&quot;):
    return js.prompt(prompt)</textarea>
            </div>
            <div id="code-cell-66-output" class="output" style="display: none;"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-67"># ValueError

try:

    age = int(input(&quot;Enter the patient&#x27;s age: &quot;))

    print(f&quot;Recorded age: {age}&quot;)

except ValueError:

    print(&quot;Error: please enter the age as a number, not text.&quot;)</textarea>
            </div>
            <button id="run-code-cell-67" class="run-button">Run Code</button>
            <div id="code-cell-67-output" class="output"></div>
        </div>
        <p>Lastly, if we trigger Python to raise a <code>NameError</code> by calling an undefined variable, we can use an <code>except</code> statement to print our own customised error message:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-68"># NameError

try:

    print(f&quot;Expression level: {gene_expression}&quot;)

except NameError:

    print(&quot;Error: the variable &#x27;gene_expression&#x27; has not been defined yet.&quot;)</textarea>
            </div>
            <button id="run-code-cell-68" class="run-button">Run Code</button>
            <div id="code-cell-68-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="summary">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Summary</h3>
                        <p>Understanding how to read, interpret and handle errors is one of the most important skills to develop early in your Python programming journey. As part of the &#x27;algorithmic thinking&#x27; that our course focuses on developing, errors are crucial, in that they help us to develop the key problem-solving skills that lie at the heart of programming, and writing good, efficient and readable code.<br><br>In this lesson, we examined how Python handles <strong>errors</strong> and how we, as programmers, can interpret and prevent them. We distinguished between <strong>syntax errors</strong>, which occur when Python cannot parse our code due to incorrect structure, and <strong>runtime errors</strong>, which appear while the program is executing valid syntax, but encounters an unexpected situation (such as dividing by zero or referencing an undefined variable). We also delved into how Python provides detailed <strong>tracebacks</strong> to help pinpoint the source and location of an error, and how understanding these messages is a key part of debugging. The lesson also introduced the use of <strong>exceptions</strong>, showing how Python raises specific error types (such as <code>ValueError</code>, <code>TypeError</code>, <code>IndexError</code>) depending on the problem encountered. Finally, we discuss strategies for <strong>error handling</strong> using <code>try</code> and <code>except</code> blocks, which allow code to fail in a controlled manner, offering workarounds for certain scenarios. Together, these ideas form a foundation for writing robust, maintainable and legible Python code.</p>
                    </div>
                </div>
            </div>
            
        
        <div class="page-navigation">
            <a href="./logical-operations-and-conditional-statements.html" class="nav-button prev">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
                Previous
            </a>
            <a href="./assignment.html" class="nav-button next">
                Next
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </a></div>
        
        <!-- Footer -->
        <div class="footer">
            <div>© All materials are copyright scryptIQ 2025</div>
            <div>Powered by Pyodide</div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../assets/main.js"></script>
    
    <!-- Pyodide Initialisation Script -->
    <script>

// Generalisable Pyodide Initialisation Script
// Variables and state build up naturally as code blocks execute in order

async function main() {
    // Show loading message for all output elements
    document.querySelectorAll(".output").forEach(el => {
        el.textContent = "Loading Pyodide...";
        el.classList.add("loading-message");
    });
    
    try {
        // Load Pyodide
        console.log("Loading Pyodide...");
        const pyodideStartTime = performance.now();
        let pyodide = await loadPyodide();
        const pyodideLoadTime = performance.now() - pyodideStartTime;
        console.log(`Pyodide loaded in ${pyodideLoadTime.toFixed(2)}ms`);
        
        // Load required packages only if specified
        const lessonPackages = window.LESSON_PACKAGES || [];
        
        if (lessonPackages.length > 0) {
            console.log("Loading required Python packages...");
            const packagesStartTime = performance.now();
            
            // Separate built-in packages from PyPI packages
            const builtInPackages = lessonPackages.filter(pkg => 
                ['numpy', 'scipy', 'matplotlib', 'pandas', 'scikit-learn', 'pillow', 'regex'].includes(pkg)
            );
            
            const micropipPackages = lessonPackages.filter(pkg => !builtInPackages.includes(pkg));
            
            // Load built-in packages (fast)
            if (builtInPackages.length > 0) {
                await pyodide.loadPackage(builtInPackages);
                console.log(`Loaded built-in packages: ${builtInPackages.join(', ')}`);
            }
            
            // Install PyPI packages (slower)
            if (micropipPackages.length > 0) {
                await pyodide.loadPackage(['micropip']);
                const micropip = pyodide.pyimport('micropip');
                await micropip.install(micropipPackages);
                console.log(`Installed PyPI packages: ${micropipPackages.join(', ')}`);
            }
            
            const packagesLoadTime = performance.now() - packagesStartTime;
            console.log(`Packages loaded in ${packagesLoadTime.toFixed(2)}ms`);
            console.log(`Total initialisation time: ${(pyodideLoadTime + packagesLoadTime).toFixed(2)}ms`);
        } else {
            console.log("No packages to load for this lesson");
            console.log(`Total initialisation time: ${pyodideLoadTime.toFixed(2)}ms`);
        }

        // Only set up basic Python environment - no pre-loaded variables
        await pyodide.runPythonAsync(`
            import sys
            from io import StringIO
        `);
        
        console.log("Pyodide loaded successfully");
        
        // Load remote files if URLs are specified
        const lessonFiles = window.LESSON_FILES || [];
        
        if (lessonFiles.length > 0) {
            try {
                console.log(`Checking for ${lessonFiles.length} remote file(s) to load...`);
                
                // Build Python code to load all files dynamically
                let pythonCode = `
from pyodide.http import pyfetch
import os

# Create data directory if it doesn't exist
os.makedirs('./data', exist_ok=True)
`;
                
                // Add loading code for each file
                for (const file of lessonFiles) {
                    pythonCode += `
# Load ${file.filename}
try:
    response = await pyfetch("${file.url}")
    content = await response.string()
    with open('./data/${file.filename}', 'w') as f:
        f.write(content)
    print("Loaded: ${file.filename}")
except Exception as e:
    print(f"Could not load ${file.filename}: {e}")
`;
                }
                
                await pyodide.runPythonAsync(pythonCode);
                console.log("Remote files loaded successfully");
            } catch (error) {
                console.warn("Error loading remote files (continuing anyway):", error);
            }
        } else {
            console.log("No remote files to load for this lesson");
        }
        
        // Function to execute Python code and capture output
        async function executePythonCode(code) {
            try {
                // Redirect Python stdout to capture print statements
                await pyodide.runPythonAsync(`
                    old_stdout = sys.stdout
                    sys.stdout = mystdout = StringIO()
                `);
                
                // Run the user code
                const result = await pyodide.runPythonAsync(code);
                
                // Get the captured stdout
                const stdout = await pyodide.runPythonAsync(`
                    sys.stdout = old_stdout
                    mystdout.getvalue()
                `);
                
                // Combine stdout and result
                let output = stdout;
                if (result !== undefined && result !== null && String(result).trim() !== '') {
                    if (output) output += "\n";
                    output += String(result);
                }
                
                return { success: true, output: output || "Code executed successfully (no output)" };
                
            } catch (error) {
                return { success: false, output: "Error: " + error.message };
            }
        }
        
        // Execute all hidden code blocks first (for setup code like imports)
        const hiddenCodeBlocks = Array.from(document.querySelectorAll('.hidden-code textarea'));
        console.log(`Found ${hiddenCodeBlocks.length} hidden code blocks`);

        for (const textarea of hiddenCodeBlocks) {
            const code = textarea.value.trim();
            if (!code) continue;
            
            console.log(`Executing hidden code block: ${textarea.id}`);
            const result = await executePythonCode(code);
            
            if (!result.success) {
                console.error(`Error in hidden code block ${textarea.id}:`, result.output);
            } else {
                console.log(`Hidden code block ${textarea.id} executed successfully`);
            }
        }

        console.log("All hidden code blocks executed");
        
        // Get all fixed code blocks in document order
        const fixedCodeBlocks = Array.from(document.querySelectorAll('.code-fixed textarea'));
        
        // Setup and execute fixed code blocks sequentially
        for (const textarea of fixedCodeBlocks) {
            const code = textarea.value.trim();
            if (!code) continue;
            
            // Set up CodeMirror editor (read-only)
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: "python",
                theme: "pastel-on-dark",
                lineNumbers: true,
                readOnly: true,
                viewportMargin: Infinity
            });
            
            // Find corresponding output element
            const outputId = textarea.id + '-output';
            const outputElement = document.getElementById(outputId);
            
            if (outputElement) {
                outputElement.textContent = "Running code...";
                outputElement.classList.add("loading-message");
                
                // Execute the code (this maintains state for subsequent blocks)
                const result = await executePythonCode(code);
                
                // Display the output - check if it's HTML
                const trimmedOutput = result.output.trim();
                console.log('Output length:', trimmedOutput.length);
                console.log('Output starts with:', trimmedOutput.substring(0, 100));
                
                if (trimmedOutput.includes('<script') && trimmedOutput.includes('Plotly')) {
                    // It's Plotly HTML output - extract just the body content
                    console.log('Rendering as Plotly HTML');
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(result.output, 'text/html');
                    // Clear the output element and append the body content
                    outputElement.innerHTML = '';
                    
                    // Find and load external scripts first (like Plotly CDN)
                    const externalScripts = Array.from(doc.querySelectorAll('script[src]'));
                    const inlineScripts = Array.from(doc.querySelectorAll('script:not([src])'));
                    
                    // Append non-script content first
                    Array.from(doc.body.children).forEach(child => {
                        if (child.tagName !== 'SCRIPT') {
                            outputElement.appendChild(child.cloneNode(true));
                        }
                    });
                    
                    // Load external scripts sequentially
                    const loadScript = (src) => {
                        return new Promise((resolve, reject) => {
                            const script = document.createElement('script');
                            script.src = src;
                            script.onload = resolve;
                            script.onerror = reject;
                            document.head.appendChild(script);
                        });
                    };
                    
                    // Load all external scripts first
                    Promise.all(externalScripts.map(s => loadScript(s.src)))
                        .then(() => {
                            console.log('External scripts loaded, executing inline scripts');
                            // Now execute inline scripts
                            inlineScripts.forEach(oldScript => {
                                const newScript = document.createElement('script');
                                newScript.textContent = oldScript.textContent;
                                outputElement.appendChild(newScript);
                            });
                            console.log('Output element after processing:', outputElement.children.length, 'children');
                        })
                        .catch(err => {
                            console.error('Failed to load external scripts:', err);
                            outputElement.textContent = 'Error loading Plotly: ' + err.message;
                        });
                } else if (trimmedOutput.startsWith('<!DOCTYPE') || 
                           trimmedOutput.startsWith('<html') ||
                           trimmedOutput.startsWith('<div')) {
                    console.log('Rendering as generic HTML');
                    outputElement.innerHTML = result.output;
                    console.log('Output element after innerHTML:', outputElement.children.length, 'children');
                } else {
                    console.log('Rendering as plain text');
                    outputElement.textContent = result.output;
                }
                outputElement.classList.remove("loading-message");
                if (result.success) {
                    outputElement.classList.add("success-message");
                    outputElement.classList.remove("error-message");
                } else {
                    outputElement.classList.add("error-message");
                    outputElement.classList.remove("success-message");
                }
            }
            
            // Small delay to show progression
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        // Setup all editable code blocks (but don't execute them)
        document.querySelectorAll('.code-editor textarea').forEach((textarea) => {
            // Set up CodeMirror editor (editable)
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: "python",
                theme: "pastel-on-dark",
                lineNumbers: true,
                viewportMargin: Infinity
            });
            
            // Find corresponding run button and output element
            const baseId = textarea.id;
            const runButtonId = 'run-' + baseId;
            const outputId = baseId + '-output';
            
            const runButton = document.getElementById(runButtonId);
            const outputElement = document.getElementById(outputId);
            
            if (runButton && outputElement) {
                // Set initial state
                outputElement.textContent = "Ready to run code!";
                outputElement.classList.remove("loading-message");
                
                runButton.addEventListener("click", async () => {
                    const code = editor.getValue().trim();
                    if (!code) {
                        outputElement.textContent = "No code to run";
                        return;
                    }
                    
                    outputElement.textContent = "Running...";
                    outputElement.classList.remove("error-message", "success-message");
                    outputElement.classList.add("loading-message");
                    
                    // Execute the code (this also maintains state for future blocks)
                    const result = await executePythonCode(code);
                    
                    // Display the output - check if it's HTML
                    const trimmedOutput = result.output.trim();
                    console.log('Output length:', trimmedOutput.length);
                    console.log('Output starts with:', trimmedOutput.substring(0, 100));
                    
                    if (trimmedOutput.includes('<script') && trimmedOutput.includes('Plotly')) {
                        // It's Plotly HTML output - extract just the body content
                        console.log('Rendering as Plotly HTML');
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(result.output, 'text/html');
                        // Clear the output element and append the body content
                        outputElement.innerHTML = '';
                        
                        // Find and load external scripts first (like Plotly CDN)
                        const externalScripts = Array.from(doc.querySelectorAll('script[src]'));
                        const inlineScripts = Array.from(doc.querySelectorAll('script:not([src])'));
                        
                        // Append non-script content first
                        Array.from(doc.body.children).forEach(child => {
                            if (child.tagName !== 'SCRIPT') {
                                outputElement.appendChild(child.cloneNode(true));
                            }
                        });
                        
                        // Load external scripts sequentially
                        const loadScript = (src) => {
                            return new Promise((resolve, reject) => {
                                const script = document.createElement('script');
                                script.src = src;
                                script.onload = resolve;
                                script.onerror = reject;
                                document.head.appendChild(script);
                            });
                        };
                        
                        // Load all external scripts first
                        Promise.all(externalScripts.map(s => loadScript(s.src)))
                            .then(() => {
                                console.log('External scripts loaded, executing inline scripts');
                                // Now execute inline scripts
                                inlineScripts.forEach(oldScript => {
                                    const newScript = document.createElement('script');
                                    newScript.textContent = oldScript.textContent;
                                    outputElement.appendChild(newScript);
                                });
                                console.log('Output element after processing:', outputElement.children.length, 'children');
                            })
                            .catch(err => {
                                console.error('Failed to load external scripts:', err);
                                outputElement.textContent = 'Error loading Plotly: ' + err.message;
                            });
                    } else if (trimmedOutput.startsWith('<!DOCTYPE') || 
                               trimmedOutput.startsWith('<html') ||
                               trimmedOutput.startsWith('<div')) {
                        outputElement.innerHTML = result.output;
                    } else {
                        outputElement.textContent = result.output;
                    }
                    outputElement.classList.remove("loading-message");
                    if (result.success) {
                        outputElement.classList.add("success-message");
                        outputElement.classList.remove("error-message");
                    } else {
                        outputElement.classList.add("error-message");
                        outputElement.classList.remove("success-message");
                    }
                });
            }
        });
        
        console.log("All code blocks initialised successfully");
        
    } catch (error) {
        console.error("Failed to initialise Pyodide:", error);
        document.querySelectorAll(".output").forEach(el => {
            el.textContent = "Error loading Pyodide: " + error.message;
            el.classList.remove("loading-message");
            el.classList.add("error-message");
        });
    }
}

// Start the application when DOM is loaded
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', main);
} else {
    main();
}
    </script>
</body>
</html>
    