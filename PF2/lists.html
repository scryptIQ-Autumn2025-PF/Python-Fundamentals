<!DOCTYPE html>
<html>
<head>
    <!-- Pyodide and CodeMirror -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/pastel-on-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="192x192" href="../assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../assets/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="../assets/android-chrome-512x512.png">
    
    <!-- Core Stylesheets -->
    <link rel="stylesheet" href="../assets/colours.css">
    <link rel="stylesheet" href="../assets/shared-styles.css">
    <link rel="stylesheet" href="../assets/nav-bar.css">
    <link rel="stylesheet" href="../assets/module_card.css">
    <link rel="stylesheet" href="../assets/learning_outcomes.css">
    <link rel="stylesheet" href="../assets/learning_lists.css">
    <link rel="stylesheet" href="../assets/box_styles.css">
    <link rel="stylesheet" href="../assets/code_styles.css">

    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L2D - PF2 - Lists</title>
    
    <!-- File URLs for this lesson -->
    <script>window.LESSON_FILES = []; window.LESSON_PACKAGES = [];</script>
        
</head>
<body>
    
    <!-- Sidebar Navigation -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
        </div>
        
        <h3>Content</h3>
        <ul>
            <li><a href="./introduction.html" class="">Introduction</a></li>
            <li>
                <div class="nav-toggle active" data-target="expandable-section-1">
                    Lists
                    <span class="toggle-icon">▼</span>
                </div>
                <ul class="nested-nav expanded" id="expandable-section-1"><li><a href="#introduction">Introduction</a></li><li><a href="#what-are-lists">What are lists?</a></li><li><a href="#creating-lists">Creating Lists</a></li><li><a href="#list-characteristics">List characteristics</a></li><li><a href="#indexing--accessing-specific-items">Indexing: accessing specific items</a></li><li><a href="#slicing--accessing-multiple-specific-items">Slicing: accessing multiple specific items</a></li><li><a href="#mutability">Mutability</a></li><li><a href="#methods">Methods</a></li><li><a href="#membership-testing">Membership testing</a></li><li><a href="#references-and-copies">References and copies</a></li><li><a href="#nested-lists">Nested Lists</a></li><li><a href="#nested-lists-as-matrices">Nested lists as matrices</a></li><li><a href="#summary">Summary</a></li>
                </ul>
            </li><li><a href="./tuples.html">Tuples</a></li><li><a href="./sets.html">Sets</a></li><li><a href="./strings.html">Strings</a></li><li><a href="./comparison.html">Comparison</a></li><li><a href="./assignment.html">Assignment</a></li><li><a href="./feedback.html">Feedback</a></li>
        </ul>

        <h3 class="collapsible-header collapsed">
            Resources
            <span class="collapse-icon">►</span>
        </h3>
        <div class="collapsible-content collapsed">
            <ul>
                <li><a href="./glossary.html">Glossary</a></li><li><a href="./downloads.html">Downloads</a></li><li><a href="../HB/introduction.html">Handbook</a></li>
            </ul>
        </div>

        <h3 class="collapsible-header collapsed">
            Previous Modules
            <span class="collapse-icon">►</span>
        </h3>
        <div class="collapsible-content collapsed">
            <ul>
            <li><a href="../PF0/introduction.html">PF0</a></li>
            <li><a href="../PF1/introduction.html">PF1</a></li>
        </ul>
        </div>

        <h3>
            <li><a href="./report-issue.html">Report an Issue</a></li>
        </h3>
    </div>
    
    <!-- Sidebar Toggle Button -->
    <button id="sidebar-toggle" class="sidebar-toggle">❮</button>
    
    <!-- Main Content Area -->
    <div id="main-content" class="main-content">
        <!-- Top Navigation Bar -->
        <div class="top-navbar">
            <h1 class="page-title">Python Fundamentals 2</h1>
            <div class="nav-actions">
            </div>
        </div>

        
            <div class="module-card" id="introduction">
                <div class="module-header">
                    Lists <span class="module-tag">PF2</span>
                </div>
                <div class="module-body">
                    <h3>Learning Objectives</h3>
                    <div class="learning-outcomes">
                        <div class="outcome-item">
                    <span class="outcome-number">1</span>
                    <span class="outcome-text">Understand how to create and manipulate Python lists</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">2</span>
                    <span class="outcome-text">Apply indexing and slicing to access items inside a list</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">3</span>
                    <span class="outcome-text">Learn about list methods and how they can modify lists</span>
                </div>
<div class="outcome-item">
                    <span class="outcome-number">4</span>
                    <span class="outcome-text">Work with nested lists</span>
                </div>
                    </div>
                    <h3>Introduction</h3>
                    <p>As explained in the introduction, Python natively contains many data structures for storing multiple values. However, what are the benefits of collecting your data points together? When working with related data points, such as multiple experimental recordings or sample IDs, handling each value individually becomes tedious. To address this, we use <strong>data structures</strong>, of which one is a <strong>list</strong>.</p>
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>Lists are a core object in Python with many of the learned components applying to other structures. You may therefore find that this section is quite lengthy. Subsequent sections that cover other data structures - namely <strong>tuples</strong>, <strong>sets</strong> and <strong>strings</strong> - will be shorter.</p>
            </div>
        </div>
        
                </div>
            </div>
            
            <div class="module-card" id="what-are-lists">
                <div class="module-body">
                    <div class="module-section">
                        <h3>What are lists?</h3>
                        <p>Lists are one of the most common data structures in Python, providing a flexible structure that can hold <em>mixed data types</em>. It is therefore important to understand how they work, how we can use them, and the features they offer to our advantage.<br><br>The easiest way to imagine how a simple 1-dimensional list works, is to think of it as a numbered list in your laboratory notebook. Each line can record a different measurement, observation or sample identifier, in sequential order. For instance, suppose you have four entries in your notebook, each recording different experimental values:</p><p><img src="./images/list_example.png" alt="Column Data" class="notebook-image"></p><p>The number of entries or <strong>items</strong> in a list determines its length. The above list of results has four entries; therefore it is said to have a length of 4.</p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Lists</strong>: One of the most common data structures in Python, providing a flexible structure that can hold mixed data types in square brackets <code>[]</code>, separated by commas.<br><br><strong>Item / Element</strong>: An individual value stored within a data structure such as a list. Also referred to as an item.</p>
            </div>
        </div>
        
        <div class="info-box fact-box">
            <div class="box-title">
                <span class="box-icon"></span>
                FACT
            </div>
            <div class="box-content">
                <p>If you have had any experience programming in other langauges, the term <strong>array</strong> is one that may be familiar. An array is a data structure that stores a collection of items, typically of the same data type, in an ordered and indexable sequence. We are introducing this term here, as it is one you may have encountered before. The term <em>array</em> is, in many ways, an overhang from older programming langauges, and is used to describe an ordered collection of items of the same type, but in Python it’s not actually a built-in structure — lists serve a similar purpose, while true arrays are provided by libraries like <strong>NumPy</strong>, which we will encounter more in the next module.</p>
            </div>
        </div>
        
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>In additition to lists, the Python ecosystem includes external packages, and one such popular package that we will use throughout our course, is <strong>NumPy</strong>. NumPy provides its own data structure type known as the <strong>NumPy array</strong>. NumPy arrays are especially useful for mathematical operations, as they support fast, item-wise computations and are optimised for performance. Unlike regular Python lists, NumPy arrays store data more efficiently and in a fixed type, making them well suited to numerical applications. However, a lot of the concepts behind lists are applicable to NumPy arrays. We will explore the differences between NumPy arrays and lists later in the Data Handling module of the course, but they are worth mentioning at this stage, due to their importance in mathematical and scientific computing.</p>
            </div>
        </div>
        
        <div class="video-container">
            <iframe 
                src="https://www.youtube.com/embed/4D1pUO5A4HY"
                width="560"
                height="315"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
            </iframe>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="creating-lists">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Creating Lists</h3>
                        <p>Lists store multiple items in square brackets <code>[]</code>, separated by commas. This can be created by placing square brackets <code>[]</code> around your comma-separated data or by using the <code>list()</code> function.</p>
        <div class="info-box tip-box">
            <div class="box-title">
                <span class="box-icon"></span>
                TIP
            </div>
            <div class="box-content">
                <p>Using square brackets <code>[]</code> is the most common method when creating a new list. Alternatively, it is possible to force another data type into a list by feeding it into the round parentheses of an in-built class: <code>list()</code>. However, there is no official consenus that specifies that one way to create a list is preferable over the other.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-1"># Storing measurements in a list:

exp_measurements = [2.3, 4.1, 3.8, 5.2, 2.9]
print(exp_measurements)</textarea>
            </div>
            <div id="code-cell-1-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-2"># A list type &lt;class &#x27;list&#x27;&gt;

print(type(exp_measurements))</textarea>
            </div>
            <div id="code-cell-2-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-3"># Use this cell to practise creating your own list.</textarea>
            </div>
            <button id="run-code-cell-3" class="run-button">Run Code</button>
            <div id="code-cell-3-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="creating-lists">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>1.</strong></p>
                <p>Create a list called <code>fibonacci</code> with these numbers - 0, 1, 1, 2, 3, 5, 8, 13, 21, 34:<ul class="nested-list"><li>Use both <code>[]</code> and <code>list()</code></li></ul></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-4"># Create your fibonacci list here</textarea>
            </div>
            <button id="run-code-cell-4" class="run-button">Run Code</button>
            <div id="code-cell-4-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="list-characteristics">
                <div class="module-body">
                    <div class="module-section">
                        <h3>List characteristics</h3>
                        <p>Some programming languages insist that all items in a list must be of the same data type, but not in Python. We can mix strings, integers, floats. We can even have functions, other lists, and more. If it&#x27;s an object in Python then it can be stored in a list.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-5"># Lists can contain mixed data types - useful for sample metadata
sample_info = [&#x27;Patient_001&#x27;, 25, &#x27;Male&#x27;, 68.5]  # ID, age, gender, weight_kg
print(sample_info)</textarea>
            </div>
            <div id="code-cell-5-output" class="output"></div>
        </div>
        <p>As shown when counting our list of entries, the number of items in your <strong>list</strong> determines its length. To find it programmatically we use the built-in function <code>len()</code>.</p>
        <div class="info-box tip-box">
            <div class="box-title">
                <span class="box-icon"></span>
                TIP
            </div>
            <div class="box-content">
                <p>You may remember <code>len()</code> from the previous lesson being used to find the number of characters in a string. This is because <code>len()</code> can be used in multiple circumstances to find the length of an object, all that is required is the object must be a sequence or a collection (data structure).</p>
            </div>
        </div>
        
        <div class="info-box fact-box">
            <div class="box-title">
                <span class="box-icon"></span>
                FACT
            </div>
            <div class="box-content">
                <p>What is an object in Python?<br><br>In Python, everything is an object, every piece of data you work with. An object is simply a container that holds data along with built-in capabilities (methods), which we&#x27;ll explore later in this lesson. This <strong>len()</strong> works with all data structures - they&#x27;re all objects that Python knows how to measure.<br><br>This is why you may hear of Python described as <strong>Object-oriented programming</strong>.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-6">exp_recordings = [1.2, 4.6, 7.3, 9.2, 2.5, 2.4]

# Use len() to find the number of items in your data collection / list

print(len(exp_recordings))</textarea>
            </div>
            <div id="code-cell-6-output" class="output"></div>
        </div>
        <p>As you can see in the cell above, the <code>len()</code> function will return an integer value, as it is a discrete count of the items in the list. This value will always be equal to, or greater than zero, with zero being returned for an empty list (a common occurrence!). This returned value can be stored in a variable to be used in the future, such as the mathematical operations, conditional statements or logical conditions you learned, previously.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-7"># We can add the length of a new list of recordings to our first set of data

exp_recordings_2 = [1.3, 4.9]

exp_1_length = len(exp_recordings)
exp_2_length = len(exp_recordings_2)

print(exp_1_length + exp_2_length)</textarea>
            </div>
            <div id="code-cell-7-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-8"># We can check if we have enough data

print(exp_1_length &gt; 5)</textarea>
            </div>
            <div id="code-cell-8-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-9"># Which can then be chained together with conditional statements to create a work flow

if exp_1_length &gt; 10:
    print(&quot;10 recordings found, stop the experiment&quot;)
else:
    print(f&quot;Not enough data points, only {exp_1_length}, please continue&quot;)</textarea>
            </div>
            <div id="code-cell-9-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="list-characteristics">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>2.</strong></p>
                <p>You&#x27;re analysing PCR amplification results from a 96-well plate experiment. You tested 12 different samples to check if your target DNA fragment is present. Each sample should produce a detectable PCR product if the target sequence is successfully amplified. The results are stored in a list: <code>pcr_products</code>.<ol class="nested-list"><li>Use the <code>len()</code> function to check how many PCR products you have</li><br><li>Write a conditional statement that prints &quot;Run complete.&quot; if you have exactly 12 products, or &quot;Incomplete run - missing samples.&quot; if you have fewer than 12</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-10">pcr_products = [&#x27;positive&#x27;, &#x27;positive&#x27;, &#x27;negative&#x27;, &#x27;positive&#x27;, &#x27;negative&#x27;, &#x27;positive&#x27;, &#x27;positive&#x27;, &#x27;positive&#x27;]</textarea>
            </div>
            <button id="run-code-cell-10" class="run-button">Run Code</button>
            <div id="code-cell-10-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="indexing--accessing-specific-items">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Indexing: accessing specific items</h3>
                        <h4>The fundamentals</h4><p>Now that we have our data inside a list, we might want to access individual or multiple items within our list.<br><br>Each item inside a list has a specific position, termed its <strong>index</strong>, which is a whole number or <strong>integer</strong>, starting with <code>0</code> which references the first position. Each subsequent character index then increases by a value of 1. We can visualise this as follows:</p><p><img src="./images/list-1.png" alt="indexing a list" class="notebook-image"></p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Index</strong>: The position of an item in a list. In Python, indexes are numbered starting from 0 for the first item.</p>
            </div>
        </div>
        
        <div class="info-box fact-box">
            <div class="box-title">
                <span class="box-icon"></span>
                FACT
            </div>
            <div class="box-content">
                <p>Why <code>0</code> and not <code>1</code> for indexing?<br><br>This is because Python, as a coding language, uses <strong>zero-based indexing</strong> as the method for finding the first item. This was chosen due to its memory efficiency and continuation from other coding languages like <strong>C</strong>.</p>
            </div>
        </div>
        <p>Now that we know the positional value (index) of each item, we can use that index to retrieve it from a list.<br><br>Given a list stored in the variable <code>my_list</code>, we can access an item by writing the variable name, followed by the index value, inside a pair of square brackets <code>[]</code>.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-11">my_list = [5, 21, 5, -1]

# To retrieve the third item we use index 2:
print(my_list[2])</textarea>
            </div>
            <div id="code-cell-11-output" class="output"></div>
        </div>
        <p>The retrieved item can then be saved to a new variable.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-12">item = my_list[3]

print(item)</textarea>
            </div>
            <div id="code-cell-12-output" class="output"></div>
        </div>
        <p>Use the code cell below to experiment with indexing into the <code>my_list</code> list object:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-13"># Have a play with indexing my_list</textarea>
            </div>
            <button id="run-code-cell-13" class="run-button">Run Code</button>
            <div id="code-cell-13-output" class="output"></div>
        </div>
        
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>You cannot access values beyond the end of the list; this will result in an <strong>error</strong>. Python reports an <code>IndexError</code> if we attempt to access a value that doesn’t exist. This kind of error is called a <strong>runtime error</strong>, as it is detected when the Python file is executed, not parsed.<br><br>When a Python script runs, the first task that the interpreter performs, is <strong>parsing</strong> - which is where it checks through the entire structure of your code, making sure that there are no syntax errors raised. Once this stage has been successfully completed, the interpreter then runs the code, line by line: and it is at this stage when a runtime error (like <code>IndexError</code>) can be raised.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-14"># Try running this cell to see the returned error

my_list[4]</textarea>
            </div>
            <button id="run-code-cell-14" class="run-button">Run Code</button>
            <div id="code-cell-14-output" class="output"></div>
        </div>
        <h4>Negative indexing</h4><p>In scenarios where you might have a long list and wish to access items at, or near to, the end of that list, it is sometimes more convenient to index an array, backwards — that is, to reference the members from the end of the list, first. This is termed <strong>negative indexing</strong>.<br><br>For example, we could have automated sampling of data from an experiment, and it may be that you are only interested in the most recent recording to check that everything is running correctly. If your list is, say, 124 items in length, it might be cumbersome to access the list using <code>exp_data[123]</code>. In such example, using negative indexing provides a cleaner and easier way to access the last value: <code>exp_data[-1]</code>. It&#x27;s easier to write than other alternatives such as <code>exp_data[len(exp_data) - 1]</code>, which relies on the <code>len()</code> function in order to retrieve the last item in the list.<br><br>The following diagram displays a list with numbers in it, and shows both the positive and negative index of each item.</p><p><img src="./images/list-2.png" alt="negative indexing a list" class="notebook-image"></p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-15">codons = [&#x27;ATG&#x27;, &#x27;GCA&#x27;, &#x27;TTC&#x27;, &#x27;TAG&#x27;]  # Start, Ala, Phe, Stop

print(f&quot;Last codon: {codons[-1]}&quot;)      # -1 = last item
print(f&quot;Second to last: {codons[-2]}&quot;)  # -2 = second from end</textarea>
            </div>
            <div id="code-cell-15-output" class="output"></div>
        </div>
        <p>Use the following code cell to play around with positive and negative indexing:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-16"># Have a play around with positive and negative indexing.
# Try accessing all items in `codons` with both.</textarea>
            </div>
            <button id="run-code-cell-16" class="run-button">Run Code</button>
            <div id="code-cell-16-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="indexing--accessing-specific-items">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>3.</strong></p>
                <p>You have the following pH readings from a fermentation experiment: <code>[6.8, 6.5, 6.2, 5.9, 5.7, 5.4]</code>:<ol class="nested-list"><li>Print the first pH (using positive indexing)</li><br><li>Print the second to last pH (using negative indexing)</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-17"># Complete the PRACTICE EXERCISE here

ph_readings = [6.8, 6.5, 6.2, 5.9, 5.7, 5.4]</textarea>
            </div>
            <button id="run-code-cell-17" class="run-button">Run Code</button>
            <div id="code-cell-17-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="obtaining-an-item-s-index-from-its-actual-value">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Obtaining an item's index from its actual value</h3>
                        <p>Often, you will be working with a large list: one where you cannot know the position of a particular value that you might be looking for. For this situation, where we know the value but not its index, we can use the method <code>.index()</code>.</p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Method</strong>: A method is a function that is attached to a specific object, and defines behaviour that is associated <em>with</em> that object. Methods are called using dot notation in Python, by typing a <code>.</code> directly after the object, followed by the method name with rounded brackets <code>()</code>. We&#x27;ll encounter more methods further in this lesson.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-18"># We have a long list of amino acids, but we&#x27;re not sure where &quot;Met&quot; is

amino_acids = [&#x27;Ala&#x27;, &#x27;Gly&#x27;, &#x27;Val&#x27;, &#x27;Leu&#x27;, &#x27;Ile&#x27;, &#x27;Pro&#x27;, &#x27;Met&#x27;, &#x27;Phe&#x27;, &#x27;Trp&#x27;, &#x27;Pro&#x27;, &#x27;Ser&#x27;]

# .index() returns the index integer

met_index = amino_acids.index(&#x27;Met&#x27;)

print(f&quot;Index of Met: {met_index}&quot;)

print(&quot;Retrieving the amino acid:&quot;, amino_acids[met_index])</textarea>
            </div>
            <div id="code-cell-18-output" class="output"></div>
        </div>
        <p>In lists with duplicated values, if a value appears more than once, the index that is returned will correspond to that value&#x27;s first occurence.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-19"># Pro is present at index 5, as well as index 9

print(amino_acids.index(&#x27;Pro&#x27;))</textarea>
            </div>
            <div id="code-cell-19-output" class="output"></div>
        </div>
        <p>A handy feature of the <code>.index()</code> method is that it will raise a <code>ValueError</code> when the value does not exist in the <code>list</code>. You can use this as a method to query large lists for wanted information. These errors were also introduced in the <a href="../PF1/errors-in-python.html"><strong>PF1</strong></a> lesson.</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-20"># Run this cell to see the error message

print(amino_acids.index(&#x27;Cys&#x27;))</textarea>
            </div>
            <button id="run-code-cell-20" class="run-button">Run Code</button>
            <div id="code-cell-20-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="slicing--accessing-multiple-specific-items">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Slicing: accessing multiple specific items</h3>
                        <p>You can also retrieve more than one value from a <code>list</code> at a time, using a mechanism called <strong>slicing</strong>. To slice a list you use square brackets <code>[]</code> directly after the variable storing your list: <code>my_list[]</code>. Slicing extracts portions of lists using a <code>[start:end]</code> notation, where start and end are integers, separated by a colon.</p>
        <div class="info-box remember-box">
            <div class="box-title">
                <span class="box-icon"></span>
                REMEMBER
            </div>
            <div class="box-content">
                <p>A slicing behaviour that is very important to note is:<br><ul class="nested-list"><li>A <strong><code>start</code></strong> index is <strong>inclusive</strong> (the value at that position is included).</li><br><li>An <strong><code>end</code></strong> index is <strong>exclusive</strong> (the value at that position is not included).</li></ul></p>
            </div>
        </div>
        <p>The diagram below helps to visualise this for more clarity:</p><p><img src="./images/list-3.png" alt="Slicing Notation" class="notebook-image"></p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-21">my_list = [5, 21, 5, -1]

my_slice = my_list[1:3]

print(my_slice)</textarea>
            </div>
            <div id="code-cell-21-output" class="output"></div>
        </div>
        <p>If we want to retrieve all the values <em>from</em> the first index, it can be written in either of two ways: <code>my_list[0:3]</code> or <code>my_list[:3]</code> with the latter being more commonly used. The start index (<code>0</code>, in this case) is done away with entirely, with Python&#x27;s interpreter implicitly treating this as meaning &#x27;all items up to&#x27; to the stop index.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-22"># Including the zero when slicing from the first index is not necessary

# With zero
print(my_list[0:3])

# Without, starting with just the :
print(my_list[:3])

# They return the same slice
print(my_list[0:3] == my_list[:3])</textarea>
            </div>
            <div id="code-cell-22-output" class="output"></div>
        </div>
        <p>The same is also true in reverse, when you wish to return all the values from a certain point in your list, all the way to end of that list. Namely, the start index is given, and the end value is left out.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-23"># Slicing to the end
print(my_list[2:])</textarea>
            </div>
            <div id="code-cell-23-output" class="output"></div>
        </div>
        <p>These principles can also be applied to negative indices, resulting in negative slicing, as follows:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-24"># Combining with negative slicing can produce the same result
print(my_list[-2:])</textarea>
            </div>
            <div id="code-cell-24-output" class="output"></div>
        </div>
        <p>In the code cell below, feel free to experiment with slicing into lists.</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-25"># Have a play with slicing lists here</textarea>
            </div>
            <button id="run-code-cell-25" class="run-button">Run Code</button>
            <div id="code-cell-25-output" class="output"></div>
        </div>
        
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>Python also provides a <code>slice()</code> function that creates reusable slice objects. This is particularly useful when you need to apply the same slice pattern to multiple lists or when the slice parameters need to be calculated programmatically.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-26">my_slice = slice(1, 3) # Retrieves items 2 and 3 in the list. Index 3 is exclusive, and not included in the slice.

print(my_list[my_slice])</textarea>
            </div>
            <div id="code-cell-26-output" class="output"></div>
        </div>
        <p>As well as a start and end index (given as integers), you can also give it a third input argument: <code>step</code>. This directs <code>slice()</code> to skip values, only returning every 2 or 3 values in your slice, for example.<br><br>Let&#x27;s create a new list, with a few more items in it, and slice into this using the <code>slice()</code> function, to obtain the first 6 items in this list:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-27">my_2nd_list = [1, 2, 3, 4, 5, 6, 7, 8, 9]

my_2nd_list[slice(0, 6)]</textarea>
            </div>
            <button id="run-code-cell-27" class="run-button">Run Code</button>
            <div id="code-cell-27-output" class="output"></div>
        </div>
        <p>And now run the cell below, which operates over the same 6 items, but skips every second item from its returned output, by the provision of <code>2</code> as the <strong>step</strong> argument:</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-28">my_2nd_list[slice(0, 6, 2)]</textarea>
            </div>
            <button id="run-code-cell-28" class="run-button">Run Code</button>
            <div id="code-cell-28-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="slicing--accessing-multiple-specific-items">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>4.</strong></p>
                <p>You&#x27;re studying bacterial growth over time and have collected optical density measurements at regular intervals. The data shows the classic bacterial growth curve with different phases. Your growth data is stored in the cell below as <code>growth_data</code>:<ol class="nested-list"><li>Extract the early phase (first 4 measurements)</li><br><li>Extract the late phase (last 3 measurements)</li><br><li>Extract the exponential phase (measurements 3-7)</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-29"># Complete the PRACTICE EXERCISE here

growth_data = [0.1, 0.2, 0.4, 0.8, 1.6, 3.2, 6.4, 12.8, 25.6, 51.2]</textarea>
            </div>
            <button id="run-code-cell-29" class="run-button">Run Code</button>
            <div id="code-cell-29-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="mutability">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Mutability</h3>
                        <p>A key property to consider in differing data structures is their <strong>mutability</strong>; that is, the capability of that data structure being changed, once it has been created. Lists are an example of a <strong>mutable</strong> data structure, and can therefore be modified <em>in situ</em> (in place) by adding, removing, and altering the items stored within them. This is done <em>via</em> built-in Python methods associated with list objects.</p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Mutable</strong>: a data type that can be changed after creation. You can modify the contents directly without creating a new object.</p>
            </div>
        </div>
        <p>We can reassign an item in a <code>list</code> through indexing, and casting a new value using hte assignment operator: <code>=</code></p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-30"># We notice an item is incorrect

amino_acids = [&#x27;Ala&#x27;, &#x27;Gly&#x27;, &#x27;Va&#x27;]

# Using the index of the item of interest we reassign it the correct value

amino_acids[2] = &#x27;Val&#x27;

print(amino_acids)</textarea>
            </div>
            <div id="code-cell-30-output" class="output"></div>
        </div>
        <p>It is also possible to perform the reassignment over a slice containing any number of values. The replacement values must be of the <strong>same length</strong> as the slice they are replacing.</p>
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-31"># We&#x27;ve decided to change the last two amino acids in our list
# Have a play with this one

amino_acids[1:] = [&#x27;Pro&#x27;, &#x27;Met&#x27;]

print(amino_acids)</textarea>
            </div>
            <button id="run-code-cell-31" class="run-button">Run Code</button>
            <div id="code-cell-31-output" class="output"></div>
        </div>
        <h4>Mutability of list members</h4><p>As discussed at the start of this lesson, <strong>lists</strong> can contain any Python object. Each object will have a data type, and a useful feature of Python lists is that they can contain <strong>multiple data types</strong> within a single list. As a result, each type will be subject to its own properties and mutability.</p>
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="methods">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Methods</h3>
                        <p>As we briefly mentioned earlier, <strong>methods</strong> are special functions associateed with an object using <strong>dot notation</strong>. Each specific data type in Python will have its own suite of methods available to it. You can think of a method as a tool that is permanently attached to a particular type of object, such as a <em>list</em>, <em>string</em> or an <em>integer</em>.</p>
        <div class="info-box remember-box">
            <div class="box-title">
                <span class="box-icon"></span>
                REMEMBER
            </div>
            <div class="box-content">
                <p>The key difference when comparing methods to functions is that <code>methods</code> are <em>dependent on their object</em>; they <strong>cannot be called independently</strong>. To call a method, we use dot notation <code>.</code> in Python, appending the method to the object using its name. I.e. <code>my_list.append(5)</code>, <code>my_list.index(3)</code>.</p>
            </div>
        </div>
        <h4>Types of methods</h4><p>Methods can be separated into two general categories:<br><ol class="nested-list"><li>Operations that <em>return</em> a result <strong>without</strong> modifying the original object.</li><br><li>Operations that <strong>modify</strong> the original object, but <em>do not return</em> anything.</li></ol></p><h4>Adding to (and combining) lists</h4><p>One useful feature of <strong>lists</strong> is the ability to add new items to them. There are two common built-in Python methods for this <code>.append()</code> and <code>.insert()</code>. Both of these methods operate <em>in situ</em>, modifying the original <em>list</em>.<br><br>As with two strings, the <code>+</code> operator can also be used to add one list to another <em>via</em> a process called <strong>concatenation</strong>.</p><h4>.append()</h4><p>The Python method <code>.append()</code> can be used to add items to the <em>end</em> of a <code>list</code>. If that item is a collection like another <code>list</code>, the entire collection is added as a <em>single item</em>, rather than merging its contents.</p>
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>When you have a list stored within another list as an item or item, we call the outer list a <strong>nested list</strong>. The inner list is referred to as a <strong>sublist</strong>, and will appear as a comma-separated item inside the outer list, and will be wrapped in square brackets <code>[]</code>.</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-32">amino_acids = [&#x27;Ala&#x27;, &#x27;Gly&#x27;, &#x27;Val&#x27;, &#x27;Leu&#x27;, &#x27;Ile&#x27;]

amino_acids.append(&#x27;Met&#x27;)

print(&quot;Appending a single value with .append():&quot;, amino_acids)

amino_acids.append([&#x27;Phe&#x27;, &#x27;Trp&#x27;])

print(&quot;Appending a list using .append():&quot;, amino_acids)</textarea>
            </div>
            <div id="code-cell-32-output" class="output"></div>
        </div>
        <p>The method <code>.insert()</code> gives you more control than <code>.append()</code>, allowing you to dictate the index position you want the new value to be. Due to this, the method takes two arguments, the first being the index, and the second the value.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-33">amino_acids.insert(2, &#x27;new AA at index 2&#x27;)

print(amino_acids)</textarea>
            </div>
            <div id="code-cell-33-output" class="output"></div>
        </div>
        <p>Adding a new item one at a time for multiple items can be time consuming and inefficient. If you have lots of new data, it is most efficient to add all the new data in one go, combining one list with another, or <strong>concatenating</strong> them. For this you can use the <code>+</code> operator, which will return a new object unlike the previous methods.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-34">amino_acids_2 = [&#x27;Met&#x27;, &#x27;Phe&#x27;, &#x27;Trp&#x27;, &#x27;Pro&#x27;, &#x27;Ser&#x27;]

new_amino_acids = amino_acids + amino_acids_2 # Concatenate two lists using `+`.

print(&quot;Original list:&quot;, amino_acids)

print(&quot;Concatenated lists:&quot;, new_amino_acids)</textarea>
            </div>
            <div id="code-cell-34-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="methods">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>5.</strong></p>
                <p>You&#x27;re recording behaviours observed during a primate study. You have a list of morning behaviours saved to the variable <code>morning_behaviours</code>:<ol class="nested-list"><li>Use <code>.append()</code> to add &#x27;vocalising&#x27; to the end of the list</li><br><li>Use <code>.insert()</code> to add &#x27;socialising&#x27; at position 1 (second position)</li><br><li>Create a new list called <code>afternoon_behaviours</code> containing <code>[&#x27;playing&#x27;, &#x27;territorial_display&#x27;]</code></li><br><li>Use the <code>+</code> operator to combine <code>morning_behaviours</code> and <code>afternoon_behaviours</code> into a new list called <code>all_behaviours</code></li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-35">morning_behaviours = [&#x27;foraging&#x27;, &#x27;grooming&#x27;, &#x27;resting&#x27;]</textarea>
            </div>
            <button id="run-code-cell-35" class="run-button">Run Code</button>
            <div id="code-cell-35-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="removing-items-from-a-list">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Removing items from a list</h3>
                        <p>It is also necessary to remove items from a list, from time to time. For example you might want to drop a feature from your dataset. As with <code>.append()</code>, we have two options depending on our needs: <code>.remove()</code> and <code>.pop()</code>. Both operate <em>in situ</em>, modifying the <code>list</code>.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-36"># Let&#x27;s remove those items we added that don&#x27;t fit the theme

amino_acids.remove(&#x27;new AA at index 2&#x27;)

print(amino_acids)</textarea>
            </div>
            <div id="code-cell-36-output" class="output"></div>
        </div>
        <p>The method <code>.pop()</code> does the same, but instead of only acting <em>in situ</em> it will also return the value too. Rather than giving the value, <code>.pop()</code> takes the index position.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-37"># Store the popped value in a new variable

unwanted_item = amino_acids.pop(-1)

print(&quot;Item that is popped:&quot;, unwanted_item)

print(&quot;Original list:&quot;, amino_acids)</textarea>
            </div>
            <div id="code-cell-37-output" class="output"></div>
        </div>
        <p>There is also a third method to remove an item <a href="https://docs.python.org/3/tutorial/datastructures.html#the-del-statement"><code>DEL</code></a>. Although it is not commonly used.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-38">print(&quot;Before:&quot;, amino_acids)

del amino_acids[0]

print(&quot;After:&quot;, amino_acids)</textarea>
            </div>
            <div id="code-cell-38-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="removing-items-from-a-list">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>6.</strong></p>
                <p>Using the <code>list</code> you created in an earlier <strong>PRACTICE EXERCISE</strong>, <code>morning_behaviours</code>:<ol class="nested-list"><li>Use <code>.remove()</code> to remove &#x27;vocalising&#x27; from the list</li><br><li>Use <code>.pop()</code> to remove &#x27;territorial_display&#x27;, and save it as a new variable</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-39"># Write your code here</textarea>
            </div>
            <button id="run-code-cell-39" class="run-button">Run Code</button>
            <div id="code-cell-39-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="other-useful-methods">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Other useful methods</h3>
                        <p>Python&#x27;s <code>list</code> type has many helpful methods beyond just adding and removing items. Below are some other commonly used methods used on lists:</p><p><strong>Count specific values:</strong> The <code>.count()</code> method tells us how many times a particular value appears in a list. This is particularly useful for analysing the frequency of an item in your data.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-40"># Count frequency of PCR results
pcr_results = [&#x27;positive&#x27;, &#x27;negative&#x27;, &#x27;positive&#x27;, &#x27;positive&#x27;, &#x27;negative&#x27;, &#x27;positive&#x27;]

positive_count = pcr_results.count(&#x27;positive&#x27;)
negative_count = pcr_results.count(&#x27;negative&#x27;)

print(f&#x27;Positive results: {positive_count}&#x27;)
print(f&#x27;Negative results: {negative_count}&#x27;)</textarea>
            </div>
            <div id="code-cell-40-output" class="output"></div>
        </div>
        <p><strong>Extending lists:</strong> The <code>.extend()</code> method adds all items from one list to another, and retains the item designation in the destination list. For instance, unlike <code>.append()</code> which adds the entire list as a single item, using <code>.extend()</code> adds all items to the list <em>as individual items</em>. And unlike using the <code>+</code> operator, <code>.extend()</code>, modifies the original list <em>in situ</em>.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-41">morning_samples = [&#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;]
evening_samples = [&#x27;B1&#x27;, &#x27;B2&#x27;, &#x27;B3&#x27;]

# Create a copy and extend it
morning_samples.extend(evening_samples)

print(&#x27;All samples:&#x27;, morning_samples)</textarea>
            </div>
            <div id="code-cell-41-output" class="output"></div>
        </div>
        <p><strong>Sorting lists:</strong> The <code>.sort()</code> method sorts items in <em>ascending</em> order, by default. Use the optional argument and set its value to <code>reverse=True</code>, for <em>descending</em> order.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-42">concentrations = [2.5, 1.2, 4.8, 3.1, 0.9, 5.2]  

# Sort ascending (lowest to highest)
concentrations.sort()
print(&#x27;Ascending:&#x27;, concentrations)

# Sort descending (highest to lowest)
concentrations.sort(reverse=True)
print(&#x27;Descending:&#x27;, concentrations)</textarea>
            </div>
            <div id="code-cell-42-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-43"># Practice: Try using .count(), .extend(), and .sort() with your own data</textarea>
            </div>
            <button id="run-code-cell-43" class="run-button">Run Code</button>
            <div id="code-cell-43-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="other-useful-methods">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>7.</strong></p>
                <p>You&#x27;re analysing enzyme activity data from multiple assays. Your data contains some duplicate readings that you want to count, and you need to sort the results. Using the <code>enzyme_activities</code> list:<ol class="nested-list"><li>Count how many times <code>85</code> appears in the data</li><br><li>Create a sorted version (ascending) of the data</li><br><li>Create a reversed version of your original list</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-44">enzyme_activities = [92, 78, 85, 91, 85, 73, 88, 85, 79, 94]</textarea>
            </div>
            <button id="run-code-cell-44" class="run-button">Run Code</button>
            <div id="code-cell-44-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="membership-testing">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Membership testing</h3>
                        <p>Often we need to check whether a specific value exists in our dataset. Python provides the <strong>membership operator keyword</strong> <code>in</code> for membership testing, which returns the boolean <code>True</code> if a value is found in the list, and <code>False</code> if not.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-45">genes_of_interest = [&#x27;BRCA1&#x27;, &#x27;TP53&#x27;, &#x27;EGFR&#x27;, &#x27;MYC&#x27;, &#x27;KRAS&#x27;]

# Check if specific genes are in our list
print(&#x27;BRCA1 in list:&#x27;, &#x27;BRCA1&#x27; in genes_of_interest)
print(&#x27;BRAF in list:&#x27;, &#x27;BRAF&#x27; in genes_of_interest)</textarea>
            </div>
            <div id="code-cell-45-output" class="output"></div>
        </div>
        <p>We can also use <code>not in</code> to check if a value is <strong>not</strong> present in the list:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-46"># Check what&#x27;s missing from our gene panel
target_genes = [&#x27;BRCA1&#x27;, &#x27;BRCA2&#x27;, &#x27;TP53&#x27;]

if &#x27;BRCA2&#x27; not in genes_of_interest:
    print(&#x27;BRCA2 is missing from our gene panel&#x27;)
else:
    print(&#x27;BRCA2 is included in our gene panel&#x27;)</textarea>
            </div>
            <div id="code-cell-46-output" class="output"></div>
        </div>
        <p>Membership testing also works with conditional statements, making it easy to create decision logic based on your data:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-47"># Checking experimental conditions
valid_conditions = [&#x27;control&#x27;, &#x27;treated&#x27;, &#x27;inhibitor&#x27;, &#x27;activator&#x27;]
current_condition = &#x27;treated&#x27;

if current_condition in valid_conditions:
    print(f&#x27;Condition {current_condition} is valid - proceeding with analysis&#x27;)
else:
    print(f&#x27;Error: {current_condition} is not a valid experimental condition&#x27;)</textarea>
            </div>
            <div id="code-cell-47-output" class="output"></div>
        </div>
        
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p><strong>Case Sensitivity:</strong> Remember that string comparisons in Python are <em>case-sensitive</em>. &#x27;Gene&#x27; and &#x27;gene&#x27; are considered different values. This is particularly important when working with biological nomenclature where case often matters (e.g., gene symbols vs. protein names).</p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-48"># Practice: Given a list of randomly generated peptide sequences, `peptides`. Determine whether or not `IVADH`, &#x27;NNVSR&#x27;, &#x27;CMGFT&#x27; exists
# Try combining your test with finding the index of the value

peptides = [
  &#x27;FAEKE&#x27;, &#x27;DMSGG&#x27;, &#x27;CMGFT&#x27;, &#x27;HVEFW&#x27;, &#x27;DCYFH&#x27;, &#x27;RDFDM&#x27;, &#x27;RTYRA&#x27;,
  &#x27;PVTEQ&#x27;, &#x27;WITFR&#x27;, &#x27;SWANQ&#x27;, &#x27;PFELC&#x27;, &#x27;KSANR&#x27;, &#x27;EQKVL&#x27;, &#x27;SYALD&#x27;,
  &#x27;FPNCF&#x27;, &#x27;SCDYK&#x27;, &#x27;MFRST&#x27;, &#x27;KFMII&#x27;, &#x27;NFYQC&#x27;, &#x27;LVKVR&#x27;, &#x27;PQKTF&#x27;,
  &#x27;LTWFQ&#x27;, &#x27;EFAYE&#x27;, &#x27;GPCCQ&#x27;, &#x27;VFDYF&#x27;, &#x27;RYSAY&#x27;, &#x27;CCTCG&#x27;, &#x27;ECFMY&#x27;,
  &#x27;CPNLY&#x27;, &#x27;CSMFW&#x27;, &#x27;NNVSR&#x27;, &#x27;SLNKF&#x27;, &#x27;CGRHC&#x27;, &#x27;LCQCS&#x27;, &#x27;AVERE&#x27;,
  &#x27;MDKHQ&#x27;, &#x27;YHKTQ&#x27;, &#x27;HVRWD&#x27;, &#x27;YNFQW&#x27;, &#x27;MGCLY&#x27;, &#x27;CQCCL&#x27;, &#x27;ACQCL&#x27;
  ]</textarea>
            </div>
            <button id="run-code-cell-48" class="run-button">Run Code</button>
            <div id="code-cell-48-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="references-and-copies">
                <div class="module-body">
                    <div class="module-section">
                        <h3>References and copies</h3>
                        <p>One of the most important concepts when working with mutable objects like lists is understanding the difference between <strong>references</strong> (also called aliases) and <strong>copies</strong>. This becomes crucial when you want to preserve your original data whilst performing modifications. It&#x27;s good practice in data exploration/analysis to keep your original data unmodified in a variable for easy access.</p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Reference</strong>: An alias created when you assign one list variable to another using <code>=</code>. Both variables point to the same list object in memory, so modifying one affects the other. For example, if <code>backup_data = original_data</code>, then <code>backup_data</code> is a reference to <code>original_data</code>, not a separate list.<br><br><strong>Copy</strong>: An independent duplicate of a list created using methods like <code>.copy()</code> or slice notation <code>[:]</code>. Changes made to a copy do not affect the original list, making it essential for preserving experimental data whilst performing modifications. For example, <code>treated_samples = control_samples.copy()</code> creates a true copy that can be modified independently.</p>
            </div>
        </div>
        <h4>References (Aliases)</h4><p>When you assign one list variable to another using <code>=</code>, you&#x27;re creating a reference, not a copy. Both variables point to the same list in memory:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-49">original_samples = [&#x27;Sample_A&#x27;, &#x27;Sample_B&#x27;, &#x27;Sample_C&#x27;]

# This creates a reference, not a copy
samples_alias = original_samples

print(&#x27;Original:&#x27;, original_samples)
print(&#x27;Alias:&#x27;, samples_alias)
print(&#x27;Are they the same object?&#x27;, original_samples is samples_alias)</textarea>
            </div>
            <div id="code-cell-49-output" class="output"></div>
        </div>
        <p>If we were to modify a new reference, the original will also be changed.</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-50"># Modifying the alias affects the original!
samples_alias.append(&#x27;Sample_D&#x27;)

print(&#x27;After modifying alias:&#x27;)
print(&#x27;Original:&#x27;, original_samples)
print(&#x27;Alias:&#x27;, samples_alias)</textarea>
            </div>
            <div id="code-cell-50-output" class="output"></div>
        </div>
        <h4>Creating True Copies</h4><p>To preserve your original data, you need to create a proper copy. Python provides two main methods:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-51">control_data = [12.5, 13.1, 12.8, 13.0, 12.9]

# Method 1: Using .copy()
treatment_data = control_data.copy()

# Method 2: Using slice notation [:]
backup_data = control_data[:]

print(&#x27;Original:&#x27;, control_data)
print(&#x27;Copy method:&#x27;, treatment_data)
print(&#x27;Slice method:&#x27;, backup_data)
print(&#x27;Are they the same object?&#x27;, control_data is treatment_data)</textarea>
            </div>
            <div id="code-cell-51-output" class="output"></div>
        </div>
        <p>Now modifications to one list won&#x27;t affect the others:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-52"># Modify the copy - original stays unchanged
treatment_data[0] = 15.2  # Simulate treatment effect

print(&#x27;After modifying copy:&#x27;)
print(&#x27;Original control:&#x27;, control_data)
print(&#x27;Modified treatment:&#x27;, treatment_data)</textarea>
            </div>
            <div id="code-cell-52-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-53"># Practice: Create references and copies to understand the difference</textarea>
            </div>
            <button id="run-code-cell-53" class="run-button">Run Code</button>
            <div id="code-cell-53-output" class="output"></div>
        </div>
        
        <div class="info-box note-box">
            <div class="box-title">
                <span class="box-icon"></span>
                NOTE
            </div>
            <div class="box-content">
                <p>The aforementioned versions of copy are called <strong>shallow copies</strong>. A shallow copy creates a <em>new list</em>, but the items in the new list are still <em>references</em> to the original items. If those items are mutable, such as being a list itself, then changing them in the copy will affect the original.<br><br>A true <strong>deep copy</strong> requires use of the <code>copy.deepcopy()</code> function from the <a href="https://docs.python.org/3/library/copy.html">copy module</a>.</p>
            </div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="nested-lists">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Nested Lists</h3>
                        <p>As you have seen throughout this section, lists can contain any data type and even mixed data types. This extends to other data structures, such as lists themselves. A list that includes at least one item that is, itself, a list is referred to as a <strong>nested list</strong>. The inner list, stored within the nested list, is referred to as a <strong>sublist</strong>.</p>
        <div class="info-box key-terms-box">
            <div class="box-title">
                <span class="box-icon"></span>
                KEY TERMS
            </div>
            <div class="box-content">
                <p><strong>Nested</strong>: A data structure that contains other data structures of the same type within it. In the context of lists, a nested list is a list that contains other lists as its items, creating a multi-dimensional structure similar to a table with rows and columns. The diagram below helps to visualise this concept.</p>
            </div>
        </div>
        <p><img src="./images/list-4.png" alt="Nested List" class="notebook-image"></p><h4>Creating nested lists</h4><p>Think of nested lists as being like a table with rows and columns, where each row is a separate list:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-54"># Experimental data: [sample_id, pH, temperature, growth_rate]
experiment_data = [
    [&#x27;Sample_1&#x27;, 7.2, 37.0, 0.85],
    [&#x27;Sample_2&#x27;, 6.8, 42.0, 0.73],
    [&#x27;Sample_3&#x27;, 7.5, 37.0, 0.91]
]

print(experiment_data)</textarea>
            </div>
            <div id="code-cell-54-output" class="output"></div>
        </div>
        <h4>Accessing items in a nested list</h4><p>To access items in nested lists, use multiple square brackets <code>[]</code>. The first index selects the row, the second selects the column:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-55"># Access specific items
print(&#x27;First sample data:&#x27;, experiment_data[0])  # First row
print(&#x27;First sample ID:&#x27;, experiment_data[0][0])  # First row, first column
print(&#x27;Second sample temperature:&#x27;, experiment_data[1][2])  # Second row, third column
print(&#x27;All growth rates:&#x27;, [row[3] for row in experiment_data])  # All fourth columns</textarea>
            </div>
            <div id="code-cell-55-output" class="output"></div>
        </div>
        <h4>Modifying nested lists</h4><p>You can modify items in nested lists just like regular lists:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-56"># Update a specific measurement
print(&#x27;Before update:&#x27;, experiment_data[1])

# Correct a temperature reading
experiment_data[1][2] = 41.5  # Second sample, temperature column

print(&#x27;After update:&#x27;, experiment_data[1])</textarea>
            </div>
            <div id="code-cell-56-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="nested-lists">
                <div class="module-body">
                    <div class="module-section">
                        
        <div class="info-box practice-exercise-box">
            <div class="box-title">
                <span class="box-icon"></span>
                PRACTICE EXERCISE
            </div>
            <div class="box-content">
                <p><strong>8.</strong></p>
                <p>You&#x27;re analysing gene expression data from a cancer research study. The data is organised as a nested list where each row contains <code>[gene_name, control_expression, treatment_1_expression, treatment_2_expression]</code>. Using the gene_expression data provided:<ol class="nested-list"><li>Print the expression levels for the TP53 gene (second row)</li><br><li>Calculate and <code>print</code> the fold change for MYC gene comparing <code>treatment_1</code> to control (<code>treatment_1</code> ÷ <code>control</code>)</li><br><li>Update the BRCA1 <code>treatment_2</code> value to 2.1 (it was incorrectly recorded)</li><br><li>Add a new gene <code>&#x27;EGFR&#x27;</code> with expression levels <code>[3.5, 5.2, 1.8]</code> to the end of the list</li></ol></p>
            </div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-57"># Gene expression matrix: [gene_name, control, treatment_1, treatment_2]
gene_expression = [
    [&#x27;BRCA1&#x27;, 2.3, 4.1, 1.8],
    [&#x27;TP53&#x27;, 1.9, 3.7, 2.1],
    [&#x27;MYC&#x27;, 3.2, 1.4, 2.9]
]

# Complete the tasks above here</textarea>
            </div>
            <button id="run-code-cell-57" class="run-button">Run Code</button>
            <div id="code-cell-57-output" class="output"></div>
        </div>
        
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="nested-lists-as-matrices">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Nested lists as matrices</h3>
                        <p>A list where at least one of the items is not a list, is considered a one-dimensional (1-D) list. A list can be considered two-dimensional (2-D) when all of its items are lists of another data collection type, themselves. If the internal data lists are all of different sizes, it is called a <strong>jagged list</strong>. The opposite, where all lists are of the same size, would be called a <strong>matrix</strong>.<br><br>Matrices are important structures in mathematics and machine learning, as they provide a standardised way to represent and manipulate data in tabular form. Their rectangular structure allows for efficient mathematical operations such as matrix multiplication, transposition, and item-wise calculations. It is therefore important that we introduce them, early on.</p><p>The implementation of a matrix is identical to other nested arrays. However, there is a visually appealing way to do so by offsetting the outer brackets of the list:</p>
        <div class="code-area">
            <div class="code-container code-fixed">
                <textarea id="code-cell-58">matrix = [
  [1, 2, 3],
  [4, 5, 6],
  [7, 8, 9]
  ]

print(matrix)</textarea>
            </div>
            <div id="code-cell-58-output" class="output"></div>
        </div>
        
        <div class="code-area">
            <div class="code-container code-editor">
                <textarea id="code-cell-59"># Play around with indexing and slicing the matrix
</textarea>
            </div>
            <button id="run-code-cell-59" class="run-button">Run Code</button>
            <div id="code-cell-59-output" class="output"></div>
        </div>
        <p>In future modules we would create this matrix using a <code>NumPy</code> array, a list-like object made specifically for numerical calculations using the popular mathematical / scientific Python library, <code>NumPy</code>.</p>
                    </div>
                </div>
            </div>
            
            <div class="module-card" id="summary">
                <div class="module-body">
                    <div class="module-section">
                        <h3>Summary</h3>
                        <p>In this section, we learned about Python <strong>lists</strong>, one of the most fundamental and versatile data structures for storing collections of data. We explored how to <strong>create lists</strong> using square brackets <strong><code>[]</code></strong> and their key characteristics: they are <strong>mutable</strong>, can hold <strong>mixed data types</strong>, and use <strong>zero-based indexing</strong>.<br><br>Lists are the backbone of many data analytics pipelines, so understanding how to get the most out of them is crucial for future learning. Although there is a lot to learn, try to remember roughly some of the possible methods and operations, in the interest of facilitating you looking these up, later on. As with much of the course, please consider this a valuable reference material for your Python programming journey, going forward.</p>
                    </div>
                </div>
            </div>
            
        
        <div class="page-navigation">
            <a href="./introduction.html" class="nav-button prev">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
                Previous
            </a>
            <a href="./tuples.html" class="nav-button next">
                Next
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </a></div>
        
        <!-- Footer -->
        <div class="footer">
            <div>© All materials are copyright scryptIQ 2025</div>
            <div>Powered by Pyodide</div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../assets/main.js"></script>
    
    <!-- Pyodide Initialisation Script -->
    <script>

// Generalisable Pyodide Initialisation Script
// Variables and state build up naturally as code blocks execute in order

async function main() {
    // Show loading message for all output elements
    document.querySelectorAll(".output").forEach(el => {
        el.textContent = "Loading Pyodide...";
        el.classList.add("loading-message");
    });
    
    try {
        // Load Pyodide
        console.log("Loading Pyodide...");
        const pyodideStartTime = performance.now();
        let pyodide = await loadPyodide();
        const pyodideLoadTime = performance.now() - pyodideStartTime;
        console.log(`Pyodide loaded in ${pyodideLoadTime.toFixed(2)}ms`);
        
        // Load required packages only if specified
        const lessonPackages = window.LESSON_PACKAGES || [];
        
        if (lessonPackages.length > 0) {
            console.log("Loading required Python packages...");
            const packagesStartTime = performance.now();
            
            // Separate built-in packages from PyPI packages
            const builtInPackages = lessonPackages.filter(pkg => 
                ['numpy', 'scipy', 'matplotlib', 'pandas', 'scikit-learn', 'pillow', 'regex'].includes(pkg)
            );
            
            const micropipPackages = lessonPackages.filter(pkg => !builtInPackages.includes(pkg));
            
            // Load built-in packages (fast)
            if (builtInPackages.length > 0) {
                await pyodide.loadPackage(builtInPackages);
                console.log(`Loaded built-in packages: ${builtInPackages.join(', ')}`);
            }
            
            // Install PyPI packages (slower)
            if (micropipPackages.length > 0) {
                await pyodide.loadPackage(['micropip']);
                const micropip = pyodide.pyimport('micropip');
                await micropip.install(micropipPackages);
                console.log(`Installed PyPI packages: ${micropipPackages.join(', ')}`);
            }
            
            const packagesLoadTime = performance.now() - packagesStartTime;
            console.log(`Packages loaded in ${packagesLoadTime.toFixed(2)}ms`);
            console.log(`Total initialisation time: ${(pyodideLoadTime + packagesLoadTime).toFixed(2)}ms`);
        } else {
            console.log("No packages to load for this lesson");
            console.log(`Total initialisation time: ${pyodideLoadTime.toFixed(2)}ms`);
        }

        // Only set up basic Python environment - no pre-loaded variables
        await pyodide.runPythonAsync(`
            import sys
            from io import StringIO
        `);

        // Only set up matplotlib if it's in the loaded packages
        if (lessonPackages.includes('matplotlib')) {
            await pyodide.runPythonAsync(`
                # Set up matplotlib for web rendering
                import matplotlib
                matplotlib.use('AGG')
                import matplotlib.pyplot as plt
                import io
                import base64
                
                def capture_matplotlib():
                    """Capture current matplotlib figure as HTML img tag"""
                    buf = io.BytesIO()
                    plt.savefig(buf, format='png', bbox_inches='tight', dpi=100)
                    buf.seek(0)
                    img_base64 = base64.b64encode(buf.read()).decode('utf-8')
                    plt.close()
                    return f'<img src="data:image/png;base64,{img_base64}" style="max-width: 100%; height: auto;" />'
            `);
            console.log('Matplotlib capture function set up');
        }
        
        console.log("Pyodide loaded successfully");
        
        // Load remote files if URLs are specified
        const lessonFiles = window.LESSON_FILES || [];
        
        if (lessonFiles.length > 0) {
            try {
                console.log(`Checking for ${lessonFiles.length} remote file(s) to load...`);
                
                // Build Python code to load all files dynamically
                let pythonCode = `
from pyodide.http import pyfetch
import os

# Create data directory if it doesn't exist
os.makedirs('./data', exist_ok=True)
`;
                
                // Add loading code for each file
                for (const file of lessonFiles) {
                    pythonCode += `
# Load ${file.filename}
try:
    response = await pyfetch("${file.url}")
    content = await response.string()
    with open('./data/${file.filename}', 'w') as f:
        f.write(content)
    print("Loaded: ${file.filename}")
except Exception as e:
    print(f"Could not load ${file.filename}: {e}")
`;
                }
                
                await pyodide.runPythonAsync(pythonCode);
                console.log("Remote files loaded successfully");
            } catch (error) {
                console.warn("Error loading remote files (continuing anyway):", error);
            }
        } else {
            console.log("No remote files to load for this lesson");
        }
        
        // Function to execute Python code and capture output
        async function executePythonCode(code) {
            try {
                // Redirect Python stdout to capture print statements
                await pyodide.runPythonAsync(`
                    old_stdout = sys.stdout
                    sys.stdout = mystdout = StringIO()
                `);
                
                // Run the user code
                const result = await pyodide.runPythonAsync(code);
                
                // Get the captured stdout
                let stdout = await pyodide.runPythonAsync(`
                    sys.stdout = old_stdout
                    mystdout.getvalue()
                `);
                
                // Check for matplotlib figures only if matplotlib was loaded
                const lessonPackages = window.LESSON_PACKAGES || [];
                if (lessonPackages.includes('matplotlib')) {
                    const hasFigures = await pyodide.runPythonAsync(`
                        import matplotlib.pyplot as plt
                        len(plt.get_fignums()) > 0
                    `);
                    
                    if (hasFigures) {
                        const figureHtml = await pyodide.runPythonAsync(`capture_matplotlib()`);
                        if (stdout) stdout += "\n";
                        stdout += figureHtml;
                    }
                }
                
                // Combine stdout and result
                let output = stdout;
                if (result !== undefined && result !== null && String(result).trim() !== '') {
                    if (output) output += "\n";
                    output += String(result);
                }
                
                return { success: true, output: output || "Code executed successfully (no output)" };
                
            } catch (error) {
                return { success: false, output: "Error: " + error.message };
            }
        }
        
        // Execute all hidden code blocks first (for setup code like imports)
        const hiddenCodeBlocks = Array.from(document.querySelectorAll('.hidden-code textarea'));
        console.log(`Found ${hiddenCodeBlocks.length} hidden code blocks`);

        for (const textarea of hiddenCodeBlocks) {
            const code = textarea.value.trim();
            if (!code) continue;
            
            console.log(`Executing hidden code block: ${textarea.id}`);
            const result = await executePythonCode(code);
            
            if (!result.success) {
                console.error(`Error in hidden code block ${textarea.id}:`, result.output);
            } else {
                console.log(`Hidden code block ${textarea.id} executed successfully`);
            }
        }

        console.log("All hidden code blocks executed");
        
        // Get all fixed code blocks in document order
        const fixedCodeBlocks = Array.from(document.querySelectorAll('.code-fixed textarea'));
        
        // Setup and execute fixed code blocks sequentially
        for (const textarea of fixedCodeBlocks) {
            const code = textarea.value.trim();
            if (!code) continue;
            
            // Set up CodeMirror editor (read-only)
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: "python",
                theme: "pastel-on-dark",
                lineNumbers: true,
                readOnly: true,
                viewportMargin: Infinity
            });
            
            // Find corresponding output element
            const outputId = textarea.id + '-output';
            const outputElement = document.getElementById(outputId);
            
            if (outputElement) {
                outputElement.textContent = "Running code...";
                outputElement.classList.add("loading-message");
                
                // Execute the code (this maintains state for subsequent blocks)
                const result = await executePythonCode(code);
                
                // Display the output - check if it's HTML
                const trimmedOutput = result.output.trim();
                console.log('Output length:', trimmedOutput.length);
                console.log('Output starts with:', trimmedOutput.substring(0, 100));
                
                if (trimmedOutput.includes('<script') && trimmedOutput.includes('Plotly')) {
                    // It's Plotly HTML output - extract just the body content
                    console.log('Rendering as Plotly HTML');
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(result.output, 'text/html');
                    // Clear the output element and append the body content
                    outputElement.innerHTML = '';
                    
                    // Find and load external scripts first (like Plotly CDN)
                    const externalScripts = Array.from(doc.querySelectorAll('script[src]'));
                    const inlineScripts = Array.from(doc.querySelectorAll('script:not([src])'));
                    
                    // Append non-script content first
                    Array.from(doc.body.children).forEach(child => {
                        if (child.tagName !== 'SCRIPT') {
                            outputElement.appendChild(child.cloneNode(true));
                        }
                    });
                    
                    // Load external scripts sequentially
                    const loadScript = (src) => {
                        return new Promise((resolve, reject) => {
                            const script = document.createElement('script');
                            script.src = src;
                            script.onload = resolve;
                            script.onerror = reject;
                            document.head.appendChild(script);
                        });
                    };
                    
                    // Load all external scripts first
                    Promise.all(externalScripts.map(s => loadScript(s.src)))
                        .then(() => {
                            console.log('External scripts loaded, executing inline scripts');
                            // Now execute inline scripts
                            inlineScripts.forEach(oldScript => {
                                const newScript = document.createElement('script');
                                newScript.textContent = oldScript.textContent;
                                outputElement.appendChild(newScript);
                            });
                            console.log('Output element after processing:', outputElement.children.length, 'children');
                        })
                        .catch(err => {
                            console.error('Failed to load external scripts:', err);
                            outputElement.textContent = 'Error loading Plotly: ' + err.message;
                        });
                } else if (trimmedOutput.startsWith('<!DOCTYPE') || 
                           trimmedOutput.startsWith('<html') ||
                            trimmedOutput.startsWith('<div') ||
                            trimmedOutput.startsWith('<img')) {
                    console.log('Rendering as generic HTML');
                    outputElement.innerHTML = result.output;
                    console.log('Output element after innerHTML:', outputElement.children.length, 'children');
                } else {
                    console.log('Rendering as plain text');
                    outputElement.textContent = result.output;
                }
                outputElement.classList.remove("loading-message");
                if (result.success) {
                    outputElement.classList.add("success-message");
                    outputElement.classList.remove("error-message");
                } else {
                    outputElement.classList.add("error-message");
                    outputElement.classList.remove("success-message");
                }
            }
            
            // Small delay to show progression
            await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        // Setup all editable code blocks (but don't execute them)
        document.querySelectorAll('.code-editor textarea').forEach((textarea) => {
            // Set up CodeMirror editor (editable)
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: "python",
                theme: "pastel-on-dark",
                lineNumbers: true,
                viewportMargin: Infinity
            });
            
            // Find corresponding run button and output element
            const baseId = textarea.id;
            const runButtonId = 'run-' + baseId;
            const outputId = baseId + '-output';
            
            const runButton = document.getElementById(runButtonId);
            const outputElement = document.getElementById(outputId);
            
            if (runButton && outputElement) {
                // Set initial state
                outputElement.textContent = "Ready to run code!";
                outputElement.classList.remove("loading-message");
                
                runButton.addEventListener("click", async () => {
                    const code = editor.getValue().trim();
                    if (!code) {
                        outputElement.textContent = "No code to run";
                        return;
                    }
                    
                    outputElement.textContent = "Running...";
                    outputElement.classList.remove("error-message", "success-message");
                    outputElement.classList.add("loading-message");
                    
                    // Execute the code (this also maintains state for future blocks)
                    const result = await executePythonCode(code);
                    
                    // Display the output - check if it's HTML
                    const trimmedOutput = result.output.trim();
                    console.log('Output length:', trimmedOutput.length);
                    console.log('Output starts with:', trimmedOutput.substring(0, 100));
                    
                    if (trimmedOutput.includes('<script') && trimmedOutput.includes('Plotly')) {
                        // It's Plotly HTML output - extract just the body content
                        console.log('Rendering as Plotly HTML');
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(result.output, 'text/html');
                        // Clear the output element and append the body content
                        outputElement.innerHTML = '';
                        
                        // Find and load external scripts first (like Plotly CDN)
                        const externalScripts = Array.from(doc.querySelectorAll('script[src]'));
                        const inlineScripts = Array.from(doc.querySelectorAll('script:not([src])'));
                        
                        // Append non-script content first
                        Array.from(doc.body.children).forEach(child => {
                            if (child.tagName !== 'SCRIPT') {
                                outputElement.appendChild(child.cloneNode(true));
                            }
                        });
                        
                        // Load external scripts sequentially
                        const loadScript = (src) => {
                            return new Promise((resolve, reject) => {
                                const script = document.createElement('script');
                                script.src = src;
                                script.onload = resolve;
                                script.onerror = reject;
                                document.head.appendChild(script);
                            });
                        };
                        
                        // Load all external scripts first
                        Promise.all(externalScripts.map(s => loadScript(s.src)))
                            .then(() => {
                                console.log('External scripts loaded, executing inline scripts');
                                // Now execute inline scripts
                                inlineScripts.forEach(oldScript => {
                                    const newScript = document.createElement('script');
                                    newScript.textContent = oldScript.textContent;
                                    outputElement.appendChild(newScript);
                                });
                                console.log('Output element after processing:', outputElement.children.length, 'children');
                            })
                            .catch(err => {
                                console.error('Failed to load external scripts:', err);
                                outputElement.textContent = 'Error loading Plotly: ' + err.message;
                            });
                    } else if (trimmedOutput.startsWith('<!DOCTYPE') || 
                               trimmedOutput.startsWith('<html') ||
                               trimmedOutput.startsWith('<div')) {
                        outputElement.innerHTML = result.output;
                    } else {
                        outputElement.textContent = result.output;
                    }
                    outputElement.classList.remove("loading-message");
                    if (result.success) {
                        outputElement.classList.add("success-message");
                        outputElement.classList.remove("error-message");
                    } else {
                        outputElement.classList.add("error-message");
                        outputElement.classList.remove("success-message");
                    }
                });
            }
        });
        
        console.log("All code blocks initialised successfully");

        // Set flag to indicate Pyodide is fully ready
        window.pyodideReady = true;
        console.log("Pyodide fully ready");
        
    } catch (error) {
        console.error("Failed to initialise Pyodide:", error);
        document.querySelectorAll(".output").forEach(el => {
            el.textContent = "Error loading Pyodide: " + error.message;
            el.classList.remove("loading-message");
            el.classList.add("error-message");
        });
    }
}

// Start the application when DOM is loaded
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', main);
} else {
    main();
}
    </script>
</body>
</html>
    